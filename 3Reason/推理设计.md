### 推理
主要是启动大模型的接口 然后保存问答数据结果  问答结果在数据库中执行来进行指标计算


我们在 /home/work/liuytest/LLaMA-Factory/src/llamafactory/chat 编写了一个python 文件 liuy_test_all_model.py 
python3 liuy_test_all_model.py /home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_base.yaml

>> 目前的问题在于 数据参数传不进去  数据保存的位置也要传进去
## 推理方案
启动的模型   计算的数据

* 核心试验
1. 使用没有微调过的模型进行推理   使用4个数据集
gemma9B GLM49B LLama8B Qwen2.57B 
那这个试验需要启动4次接口
```
python3 -u liuy_test_all_model.py 

/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_base.yaml   /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_normal_test_7_3.json gemma9B_base_normal_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_base.yaml   /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_prompt_test_7_3.json gemma9B_base_schema_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_base.yaml   /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_vector_prompt_test_7_3.json gemma9B_base_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_base.yaml   /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_vector_prompt_test_7_3.json gemma9B_base_schema_vector_prompt.json

/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_base.yaml /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_normal_test_7_3.json Qwen2.57B_base_normal_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_base.yaml /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_prompt_test_7_3.json Qwen2.57B_base_schema_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_base.yaml /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_vector_prompt_test_7_3.json Qwen2.57B_base_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_base.yaml /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_vector_prompt_test_7_3.json Qwen2.57B_base_schema_vector_prompt.json

/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_base.yaml    /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_normal_test_7_3.json GLM49B_base_normal_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_base.yaml    /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_prompt_test_7_3.json GLM49B_base_schema_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_base.yaml    /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_vector_prompt_test_7_3.json GLM49B_base_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_base.yaml    /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_vector_prompt_test_7_3.json GLM49B_base_schema_vector_prompt.json

/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_base.yaml   /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_normal_test_7_3.json LLama8B_base_normal_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_base.yaml   /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_prompt_test_7_3.json LLama8B_base_schema_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_base.yaml   /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_vector_prompt_test_7_3.json LLama8B_base_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_base.yaml   /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_vector_prompt_test_7_3.json LLama8B_base_schema_vector_prompt.json
```

2. 使用微调后的模型进行推理 
gemma9B GLM49B LLama8B Qwen2.57B  
每个模型训练了4次  分别使用训练数据集对应的测试集进行测试
那这个试验需要启动16次接口
```
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_train_normal_prompt.yaml               /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_normal_test_7_3.json gemma9B_train_normal_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_train_schema_prompt.yaml               /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_prompt_test_7_3.json gemma9B_train_schema_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_train_vector_prompt.yaml               /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_vector_prompt_test_7_3.json gemma9B_train_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_train_my_prompt.yaml                   /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_vector_prompt_test_7_3.json gemma9B_train_schema_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_train_normal_prompt.yaml                /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_normal_test_7_3.json GLM49B_train_normal_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_train_schema_prompt.yaml                /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_prompt_test_7_3.json GLM49B_train_schema_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_train_vector_prompt.yaml                /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_vector_prompt_test_7_3.json GLM49B_train_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_train_my_prompt.yaml                    /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_vector_prompt_test_7_3.json GLM49B_train_schema_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_train_normal_prompt.yaml               /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_normal_test_7_3.json LLama8B_train_normal_prompt.json  
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_train_schema_prompt.yaml               /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_prompt_test_7_3.json LLama8B_train_schema_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_train_vector_prompt.yaml               /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_vector_prompt_test_7_3.json LLama8B_train_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_train_my_prompt.yaml                   /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_vector_prompt_test_7_3.json LLama8B_train_schema_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_train_normal_prompt.yaml             /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_normal_test_7_3.json Qwen2.57B_train_normal_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_train_schema_prompt.yaml             /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_prompt_test_7_3.json Qwen2.57B_train_schema_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_train_vector_prompt.yaml             /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_vector_prompt_test_7_3.json Qwen2.57B_train_vector_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_train_my_prompt.yaml                 /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_vector_prompt_test_7_3.json Qwen2.57B_train_schema_vector_prompt.json
``` 

* 模型大小实验
Qwen2.50.5B  Qwen2.51.5B Qwen2.53B Qwen2.57B Qwen2.514B Qwen2.532B
使用6个模型  同时还要使用我们的数据集
```
/home/work/liuytest/LLaMA-Factory/examples/inference/model_size_Qwen2.50.5B_my_prompt.yaml          /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_vector_prompt_test_7_3.json model_size_Qwen2.50.5B_my_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/model_size_Qwen2.51.5B_my_prompt.yaml          /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_vector_prompt_test_7_3.json model_size_Qwen2.51.5B_my_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/model_size_Qwen2.53B_my_prompt.yaml            /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_vector_prompt_test_7_3.json model_size_Qwen2.53B_my_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/model_size_Qwen2.57B_my_prompt.yaml            /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_vector_prompt_test_7_3.json model_size_Qwen2.57B_my_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/model_size_Qwen2.514B_my_prompt.yaml           /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_vector_prompt_test_7_3.json model_size_Qwen2.514B_my_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/model_size_Qwen2.532B_my_prompt.yaml           /home/work/liuytest/大论文/2微调/主训练测试数据集/ldbc_with_schema_vector_prompt_test_7_3.json model_size_Qwen2.532B_my_prompt.json
```


* 数据集规模实验
Qwen2.57B  模型规模输出了9个output  因此我们使用9个配置文件  数据集使用 我们的数据集
```
/home/work/liuytest/LLaMA-Factory/examples/inference/scala_1_9_Qwen2.57B_train_my_prompt.yaml        /home/work/liuytest/大论文/2微调/数据集规模测试/ldbc_with_schema_vector_prompt_test_1_9.json scala_1_9_Qwen2.57B_my_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/scala_2_8_Qwen2.57B_train_my_prompt.yaml        /home/work/liuytest/大论文/2微调/数据集规模测试/ldbc_with_schema_vector_prompt_test_2_8.json scala_2_8_Qwen2.57B_my_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/scala_3_7_Qwen2.57B_train_my_prompt.yaml        /home/work/liuytest/大论文/2微调/数据集规模测试/ldbc_with_schema_vector_prompt_test_3_7.json scala_3_7_Qwen2.57B_my_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/scala_4_6_Qwen2.57B_train_my_prompt.yaml        /home/work/liuytest/大论文/2微调/数据集规模测试/ldbc_with_schema_vector_prompt_test_4_6.json scala_4_6_Qwen2.57B_my_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/scala_5_5_Qwen2.57B_train_my_prompt.yaml        /home/work/liuytest/大论文/2微调/数据集规模测试/ldbc_with_schema_vector_prompt_test_5_5.json scala_5_5_Qwen2.57B_my_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/scala_6_4_Qwen2.57B_train_my_prompt.yaml        /home/work/liuytest/大论文/2微调/数据集规模测试/ldbc_with_schema_vector_prompt_test_6_4.json scala_6_4_Qwen2.57B_my_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/scala_7_3_Qwen2.57B_train_my_prompt.yaml        /home/work/liuytest/大论文/2微调/数据集规模测试/ldbc_with_schema_vector_prompt_test_7_3.json scala_7_3_Qwen2.57B_my_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/scala_8_2_Qwen2.57B_train_my_prompt.yaml        /home/work/liuytest/大论文/2微调/数据集规模测试/ldbc_with_schema_vector_prompt_test_8_2.json scala_8_2_Qwen2.57B_my_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/scala_9_1_Qwen2.57B_train_my_prompt.yaml        /home/work/liuytest/大论文/2微调/数据集规模测试/ldbc_with_schema_vector_prompt_test_9_1.json scala_9_1_Qwen2.57B_my_prompt.json
```


* 领域迁移试验 
gemma9B GLM49B LLama8B Qwen2.57B  各个训练之后 使用 医疗领域和金融领域 的各个prompt 分别测试  评测各个模型的迁移能力和prompt的迁移能力

1. 金融领域
```
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_train_normal_prompt.yaml               /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_normal.json                       finbench_gemma9B_train_normal_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_train_schema_prompt.yaml               /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_with_schema_prompt.json           finbench_gemma9B_train_schema_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_train_vector_prompt.yaml               /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_with_vector_prompt.json           finbench_gemma9B_train_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_train_my_prompt.yaml                   /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_with_schema_vector_prompt.json    finbench_emma9B_train_schema_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_train_normal_prompt.yaml                /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_normal.json                        finbench_GLM49B_train_normal_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_train_schema_prompt.yaml                /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_with_schema_prompt.json            finbench_GLM49B_train_schema_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_train_vector_prompt.yaml                /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_with_vector_prompt.json            finbench_GLM49B_train_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_train_my_prompt.yaml                    /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_with_schema_vector_prompt.json     finbench_GLM49B_train_schema_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_train_normal_prompt.yaml               /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_normal.json                      finbench_LLama8B_train_normal_prompt.json  
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_train_schema_prompt.yaml               /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_with_schema_prompt.json          finbench_LLama8B_train_schema_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_train_vector_prompt.yaml               /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_with_vector_prompt.json          finbench_LLama8B_train_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_train_my_prompt.yaml                   /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_with_schema_vector_prompt.json   finbench_LLama8B_train_schema_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_train_normal_prompt.yaml             /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_normal.json                     finbench_Qwen2.57B_train_normal_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_train_schema_prompt.yaml             /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_with_schema_prompt.json         finbench_Qwen2.57B_train_schema_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_train_vector_prompt.yaml             /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_with_vector_prompt.json         finbench_Qwen2.57B_train_vector_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_train_my_prompt.yaml                 /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/finbench_with_schema_vector_prompt.json  finbench_Qwen2.57B_train_schema_vector_prompt.json
```
2. 医疗领域
```
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_train_normal_prompt.yaml   /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_normal.json                       medical_gemma9B_train_normal_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_train_schema_prompt.yaml   /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_with_schema_prompt.json           medical_gemma9B_train_schema_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_train_vector_prompt.yaml   /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_with_vector_prompt.json           medical_gemma9B_train_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/gemma9B_train_my_prompt.yaml       /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_with_schema_vector_prompt.json    medical_emma9B_train_schema_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_train_normal_prompt.yaml    /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_normal.json                         medical_GLM49B_train_normal_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_train_schema_prompt.yaml    /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_with_schema_prompt.json             medical_GLM49B_train_schema_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_train_vector_prompt.yaml    /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_with_vector_prompt.json             medical_GLM49B_train_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/GLM49B_train_my_prompt.yaml        /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_with_schema_vector_prompt.json      medical_GLM49B_train_schema_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_train_normal_prompt.yaml   /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_normal.json                       medical_LLama8B_train_normal_prompt.json  
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_train_schema_prompt.yaml   /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_with_schema_prompt.json           medical_LLama8B_train_schema_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_train_vector_prompt.yaml   /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_with_vector_prompt.json           medical_LLama8B_train_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/LLama8B_train_my_prompt.yaml       /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_with_schema_vector_prompt.json    medical_LLama8B_train_schema_vector_prompt.json
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_train_normal_prompt.yaml /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_normal.json                      medical_Qwen2.57B_train_normal_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_train_schema_prompt.yaml /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_with_schema_prompt.json          medical_Qwen2.57B_train_schema_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_train_vector_prompt.yaml /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_with_vector_prompt.json          medical_Qwen2.57B_train_vector_prompt.json 
/home/work/liuytest/LLaMA-Factory/examples/inference/Qwen2.57B_train_my_prompt.yaml     /home/work/liuytest/大论文/3推理/跨领域测试数据集生成/medical_with_schema_vector_prompt.json   medical_Qwen2.57B_train_schema_vector_prompt.json
```
* 接口调用脚本 
接口调用之后 需要保存推理的结果  这样就不用再启动大模型了  后续工作就可以在个人电脑上做了









### 查漏补缺 
第一次运行之后 出现了很多运行失败的脚本  主要原因是 NPU 不够用
考虑把数据集中的prompt变短才行
以下进行列表：

 

